{% extends "base.html" %}
{% block title %} Index {% endblock %}

{% block body %}
<div x-data="{ txInput: {{random_transact}} }" class="p-4 md:p-6 bg-gray-100 font-sans min-h-screen">
    <div class="max-w-3xl mx-auto bg-white p-5 sm:p-8 rounded-xl shadow-2xl">

        <h1 class="text-3xl sm:text-4xl font-bold text-slate-800 mb-8 text-center tracking-tight">
            Blockchain Control Panel
        </h1>

        <form method="POST" class="mb-10 p-4 sm:p-6 bg-slate-50 border border-slate-200 rounded-lg shadow-md">
            {% csrf_token %}
            <div class="flex flex-col sm:flex-row sm:items-end sm:space-x-4">
                <div class="flex-grow mb-4 sm:mb-0">
                    <label for="index_input_tx" class="block text-sm font-semibold text-slate-700 mb-1.5">
                        Number of TX to Generate:
                    </label>
                    <input
                        type="number"
                        x-model.number="txInput"
                        id="index_input_tx"
                        name="index_input_tx"
                        min="0"
                        class="mt-1 block w-full px-4 py-2.5 bg-white border border-slate-300 rounded-md shadow-sm text-slate-900 placeholder-slate-400
                               focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm transition-shadow duration-150"
                        placeholder="e.g., 5"
                    />
                </div>
                <button
                    type="submit"
                    class="w-full sm:w-auto px-6 py-2.5 bg-indigo-600 text-white font-semibold rounded-md shadow-md
                           hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2
                           transition-all duration-150 ease-in-out active:bg-indigo-800 transform active:scale-95"
                >
                    Generate
                </button>
            </div>
        </form>

        <div class="grid grid-cols-1 md:grid-cols-4 gap-2 sm:gap-2 mb-10 ">
            <div class="p-4 sm:p-5 bg-sky-50 border border-sky-200 rounded-xl shadow-lg hover:shadow-sky-300 transition-shadow duration-300">
                <h3 class="text-xs font-semibold text-sky-600 uppercase tracking-wider mb-1">Account Balance</h3>
                <p class="text-3xl sm:text-3xl font-mono font-bold text-sky-800" x-text="{{accounts.balance}}"></p>
            </div>
            <div class="p-4 sm:p-5 bg-red-50 border border-red-200 rounded-xl shadow-lg hover:shadow-red-300 transition-shadow duration-300">
                <h3 class="text-xs font-semibold text-red-500 uppercase tracking-wider mb-1">Pending TXs</h3><p class="text-xs text-red-500">(Cap: {{PENDING_NO}})</p>
                <p class="text-2xl sm:text-3xl font-mono font-bold text-sky-800" x-text="{{bc.number_of_pending_txs}}"></p>
            </div>
            <div class="p-4 sm:p-5 bg-lime-50 border border-lime-200 rounded-xl shadow-lg hover:shadow-lime-300 transition-shadow duration-300">
                <h3 class="text-xs font-semibold text-lime-600 uppercase tracking-wider mb-1">TX to Generate (Input)</h3>
                <p class="text-2xl sm:text-3xl font-mono font-bold text-lime-800" x-text="txInput"></p>
            </div>
            <div class="p-4 sm:p-5 bg-amber-50 border border-amber-200 rounded-xl shadow-lg hover:shadow-amber-300 transition-shadow duration-300">
                <h3 class="text-xs font-semibold text-amber-600 uppercase tracking-wider mb-1">Current Blocks in Chain</h3>
                <p class="text-2xl sm:text-3xl font-mono font-bold text-amber-800" x-text="{{bc.no_blocks}}"></p>
            </div>
        </div>

        <details class="mb-6 border border-slate-300 rounded-lg shadow-md overflow-hidden group" name="blockchain_json_details">
            <summary class="flex justify-between items-center p-3 sm:p-4 font-semibold cursor-pointer bg-slate-100 hover:bg-slate-200 transition-colors duration-150 ease-in-out text-slate-700 list-none">
                <span>Full Blockchain Data (JSON)</span>
                <svg class="w-5 h-5 text-slate-500 transform transition-transform duration-300 ease-in-out group-open:rotate-180" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
                </svg>
            </summary>
            <div class="p-3 sm:p-4 bg-slate-50 border-t border-slate-200">
                <pre class="text-xs sm:text-sm text-slate-800 bg-white p-3 sm:p-4 border border-slate-200 rounded-md shadow-inner overflow-auto max-h-96 whitespace-pre-wrap break-words leading-relaxed"><code x-text="{{bc_nblocks}}"></code></pre>
            </div>
        </details>

        <details open class="border border-slate-300 rounded-lg shadow-md overflow-hidden group" name="details1_test">
            <summary class="flex justify-between items-center p-3 sm:p-4 font-semibold cursor-pointer bg-slate-100 hover:bg-slate-200 transition-colors duration-150 ease-in-out text-slate-700 list-none">
                <span>Ledger</span>
                 <svg class="w-5 h-5 text-slate-500 transform transition-transform duration-300 ease-in-out group-open:rotate-180" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
                </svg>
            </summary>
            <div class="p-3 sm:p-4 bg-slate-50 text-slate-700 border-t border-slate-200">
                <p class="mt-2 text-xs text-slate-600">{{bc.ledger.to_json}}</p>
                <p class="mt-2 text-xs text-slate-600">{{bc.get_active_wallets}}</p>
            </div>
        </details>

    </div>
</div>

{% endblock %}